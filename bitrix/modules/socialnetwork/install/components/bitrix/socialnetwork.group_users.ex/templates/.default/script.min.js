var waitDiv=null;var waitPopup=null;var waitTimeout=null;var waitTime=500;function __GUEtoggleCheckbox(e,s,r){e=e||window.event;if(r=="undefined"||!r)return false;var o=r.substr(0,1);var t=parseInt(r.substr(1));switch(o){case"M":if(BX.util.in_array(t,actionUsers["Moderators"]))actionUsers["Moderators"].splice(BX.util.array_search(t,actionUsers["Moderators"]),1);else actionUsers["Moderators"][actionUsers["Moderators"].length]=t;break;case"U":if(BX.util.in_array(t,actionUsers["Users"]))actionUsers["Users"].splice(BX.util.array_search(t,actionUsers["Users"]),1);else actionUsers["Users"][actionUsers["Users"].length]=t;break;case"B":if(BX.message("GUEUseBan")=="Y"){if(BX.util.in_array(t,actionUsers["Banned"]))actionUsers["Banned"].splice(BX.util.array_search(t,actionUsers["Banned"]),1);else actionUsers["Banned"][actionUsers["Banned"].length]=t}break;default:return false}var n=BX.findChild(s,{tagName:"input"},true,false);if(e.target==n||e.srcElement==n){BX.toggleClass(s.parentNode,"sonet-members-member-block-active");return false}else{BX.toggleClass(s.parentNode,"sonet-members-member-block-active");n.checked=n.checked==true?false:true}BX.PreventDefault(e)}function __GUEShowMenu(e,s,r){if(!s)s="users";var o=[];if(s=="users"){if(BX.message("GUEUserCanInitiate"))o[o.length]={text:BX.message("GUEAddToUsersTitle"),className:"menu-popup-no-icon",onclick:function(e){if(BX.SGCP){BX.SGCP.ShowForm("invite",r,e)}return BX.PreventDefault(e)}};if(BX.message("GUEUserCanModifyGroup")){o[o.length]={text:BX.message("GUEAddToModeratorsTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUEAddToModerators(this.popupWindow);return BX.PreventDefault(e)}};o[o.length]={text:BX.message("GUEExcludeFromGroupTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUEExcludeFromGroup(this.popupWindow);return BX.PreventDefault(e)}}}if(BX.message("GUEUserCanModifyGroup"))o[o.length]={text:BX.message("GUESetGroupOwnerTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUESetGroupOwner(this.popupWindow);return BX.PreventDefault(e)}}}else if(s=="moderators"){if(BX.message("GUEUserCanModifyGroup")){o[o.length]={text:BX.message("GUEExcludeFromModeratorsTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUEExcludeFromModerators(this.popupWindow);return BX.PreventDefault(e)}};o[o.length]={text:BX.message("GUEExcludeFromGroupTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUEExcludeFromGroup(this.popupWindow);return BX.PreventDefault(e)}}}if(BX.message("GUEUserCanModifyGroup"))o[o.length]={text:BX.message("GUESetGroupOwnerTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUESetGroupOwner(this.popupWindow);return BX.PreventDefault(e)}}}else if(s=="ban"){if(BX.message("GUEUserCanModerateGroup"))o[o.length]={text:BX.message("GUEUnBanFromGroupTitle"),className:"menu-popup-no-icon",onclick:function(e){__GUEUnBanFromGroup(this.popupWindow);return BX.PreventDefault(e)}}}if(o.length>0){var t={offsetLeft:-32,offsetTop:4,lightShadow:false,angle:{position:"top",offset:60}};BX.PopupMenu.show("gue-menu-"+s,e,o,t)}}function __GUEAddToModerators(e){if(actionUsers["Users"].length>0){__GUEShowWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"U2M",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:actionUsers["Users"],sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:function(s){__GUEProcessAJAXResponse(s,e)}})}else __GUEShowError(BX.message("GUEErrorUserIDNotDefined"))}function __GUEExcludeFromModerators(e){if(actionUsers["Moderators"].length>0){__GUEShowWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"M2U",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:actionUsers["Moderators"],sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:function(s){__GUEProcessAJAXResponse(s,e)}})}else __GUEShowError(BX.message("GUEErrorUserIDNotDefined"))}function __GUEExcludeFromGroup(e){if(confirm(BX.message("GUEExcludeFromGroupConfirmTitle"))){if(actionUsers["Moderators"].length>0||actionUsers["Users"].length>0){var s=BX.util.array_merge(actionUsers["Moderators"],actionUsers["Users"]);__GUEShowWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"EX",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:s,sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:function(s){__GUEProcessAJAXResponse(s,e)}})}else __GUEShowError(BX.message("GUEErrorUserIDNotDefined"))}}function __GUEBanFromGroup(e){if(actionUsers["Moderators"].length>0||actionUsers["Users"].length>0){var s=BX.util.array_merge(actionUsers["Moderators"],actionUsers["Users"]);__GUEShowWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"BAN",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:s,sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:function(s){__GUEProcessAJAXResponse(s,e)}})}else __GUEShowError(BX.message("GUEErrorUserIDNotDefined"))}function __GUEUnBanFromGroup(e){if(actionUsers["Banned"].length>0){__GUEShowWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"UNBAN",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:actionUsers["Banned"],sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:function(s){__GUEProcessAJAXResponse(s,e)}})}else __GUEShowError(BX.message("GUEErrorUserIDNotDefined"))}function __GUESetGroupOwner(e){if((actionUsers["Moderators"].length===1||actionUsers["Users"].length===1)&&!(actionUsers["Moderators"].length===1&&actionUsers["Users"].length===1)){var s=parseInt(actionUsers["Moderators"].length===1?actionUsers["Moderators"][0]:actionUsers["Users"][0]);if(typeof oldOwnerID!="undefined"&&s==parseInt(oldOwnerID))__GUEShowError(BX.message("GUEErrorSameOwner"));else if(confirm(BX.message("GUESetGroupOwnerConfirmTitle"))){__GUEShowWait();BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.group_users.ex/ajax.php",method:"POST",dataType:"json",data:{ACTION:"SETOWNER",GROUP_ID:parseInt(BX.message("GUEGroupId")),USER_ID:[s],sessid:BX.bitrix_sessid(),site:BX.util.urlencode(BX.message("GUESiteId"))},onsuccess:function(s){__GUEProcessAJAXResponse(s,e)}})}}else __GUEShowError(BX.message("GUEErrorUserIDIncorrect"))}function __GUEProcessAJAXResponse(e,s){if(s=="undefined"||s==null||!s.isShown())return false;if(e["SUCCESS"]!="undefined"&&e["SUCCESS"]=="Y"){s.close();BX.reload()}else if(e["ERROR"]!="undefined"&&e["ERROR"].length>0){if(e["ERROR"].indexOf("USER_ACTION_FAILED",0)===0){__GUEShowError(BX.message("GUEErrorActionFailedPattern").replace("#ERROR#",e["ERROR"].substr(20)));return false}else if(e["ERROR"].indexOf("SESSION_ERROR",0)===0){__GUEShowError(BX.message("GUEErrorSessionWrong"));BX.reload()}else if(e["ERROR"].indexOf("USER_GROUP_NO_PERMS",0)===0){__GUEShowError(BX.message("GUEErrorNoPerms"));return false}else if(e["ERROR"].indexOf("USER_ID_NOT_DEFINED",0)===0){__GUEShowError(BX.message("GUEErrorUserIDNotDefined"));return false}else if(e["ERROR"].indexOf("GROUP_ID_NOT_DEFINED",0)===0){__GUEShowError(BX.message("GUEErrorGroupIDNotDefined"));return false}else if(e["ERROR"].indexOf("CURRENT_USER_NOT_AUTH",0)===0){__GUEShowError(BX.message("GUEErrorCurrentUserNotAuthorized"));return false}else if(e["ERROR"].indexOf("SONET_MODULE_NOT_INSTALLED",0)===0){__GUEShowError(BX.message("GUEErrorModuleNotInstalled"));return false}else if(e["ERROR"].indexOf("SONET_GUE_T_OWNER_CANT_EXCLUDE_HIMSELF",0)===0){__GUEShowError(BX.message("GUEErrorOwnerCantExcludeHimself"));return false}else{__GUEShowError(e["ERROR"]);return false}}}function __GUEShowError(e){__GUECloseWait();var s=new BX.PopupWindow("gue-error"+Math.random(),window,{autoHide:true,lightShadow:false,zIndex:2,content:BX.create("DIV",{props:{className:"sonet-members-error-text-block"},html:e}),closeByEsc:true,closeIcon:true});s.show()}function __GUEShowWait(e){if(e!==0){return waitTimeout=setTimeout(function(){__GUEShowWait(0)},50)}if(!waitPopup){waitPopup=new BX.PopupWindow("gue_wait",window,{autoHide:true,lightShadow:true,zIndex:2,content:BX.create("DIV",{props:{className:"sonet-members-wait-cont"},children:[BX.create("DIV",{props:{className:"sonet-members-wait-icon"}}),BX.create("DIV",{props:{className:"sonet-members-wait-text"},html:BX.message("GUEWaitTitle")})]})})}else waitPopup.setBindElement(window);waitPopup.show()}function __GUECloseWait(){if(waitTimeout){clearTimeout(waitTimeout);waitTimeout=null}if(waitPopup)waitPopup.close()}
//# sourceMappingURL=script.map.js