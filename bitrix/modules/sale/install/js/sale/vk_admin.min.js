(function(t){if(!BX.Sale)BX.Sale={};if(!BX.Sale.VkAdmin){BX.Sale.VkAdmin={}}BX.Sale.VkAdmin={ajaxUrl:"/bitrix/admin/sale_vk_ajax.php",startFeed:function(t,e,s){BX.Sale.VkAdmin.exportProcessProlog();if(s)BX.cleanNode(BX("vk_export_notify__progress"));BX.showWait();var a={action:"startFeed",type:t,exportId:e,firstRun:s,sessid:BX.bitrix_sessid()};BX.ajax({timeout:120,method:"POST",dataType:"json",url:BX.Sale.VkAdmin.ajaxUrl,data:a,onsuccess:function(t){if(t&&t.ERRORS_CRITICAL){BX.closeWait();BX.adjust(BX("vk_export_notify__error_critical"),{style:{display:"block"}});BX.adjust(BX("vk_export_notify__error_critical"),{html:t.ERRORS_CRITICAL});BX.Sale.VkAdmin.exportProcessEpilog()}else{if(t&&t.CONTINUE){BX.closeWait();BX.Sale.VkAdmin.startFeed(t.TYPE,e,false)}else{BX.closeWait();BX.Sale.VkAdmin.exportProcessEpilog()}if(t.PROGRESS.length>0)BX.adjust(BX("vk_export_notify__progress"),{html:t.PROGRESS});if(t.STATS_ALBUMS.length>0)BX.adjust(BX("vk_export_statistic__albums"),{html:t.STATS_ALBUMS});if(t.STATS_PRODUCTS.length>0)BX.adjust(BX("vk_export_statistic__products"),{html:t.STATS_PRODUCTS});if(t.ERRORS_NORMAL.length>0){BX.adjust(BX("vk_export_notify__error_normal"),{style:{display:"block"}});BX.adjust(BX("vk_export_notify__error_normal__msg"),{html:t.ERRORS_NORMAL})}}},onfailure:function(){BX.closeWait();BX.Sale.VkAdmin.exportProcessEpilog();BX.debug("Feed failure!");location.reload()}})},exportProcessProlog:function(){BX.adjust(BX("vk_export_button__startFeed_all"),{props:{disabled:true}});BX.adjust(BX("vk_export_button__startFeed_add"),{style:{display:"none"}});BX.adjust(BX("vk_export_button__startFeed_delete"),{style:{display:"none"}});BX.addClass(BX("vk_export_button__startFeed_add"),"adm-btn-disabled");BX.addClass(BX("vk_export_button__startFeed_delete"),"adm-btn-disabled");BX.adjust(BX("vk_export_button__save"),{props:{disabled:true}});BX.adjust(BX("vk_export_button__apply"),{props:{disabled:true}});BX.adjust(BX("vk_export_button__cancel"),{props:{disabled:true}})},exportProcessEpilog:function(){BX.adjust(BX("vk_export_button__startFeed_all"),{props:{disabled:false}});BX.adjust(BX("vk_export_button__startFeed_add"),{style:{display:"inline-block"}});BX.adjust(BX("vk_export_button__startFeed_delete"),{style:{display:"inline-block"}});BX.removeClass(BX("vk_export_button__startFeed_add"),"adm-btn-disabled");BX.removeClass(BX("vk_export_button__startFeed_delete"),"adm-btn-disabled");BX.adjust(BX("vk_export_button__save"),{props:{disabled:false}});BX.adjust(BX("vk_export_button__apply"),{props:{disabled:false}});BX.adjust(BX("vk_export_button__cancel"),{props:{disabled:false}})},stopProcess:function(t){BX.showWait();var e={action:"stopProcess",exportId:t,sessid:BX.bitrix_sessid()};BX.ajax({timeout:120,method:"POST",dataType:"json",url:BX.Sale.VkAdmin.ajaxUrl,data:e,onsuccess:function(t){BX.closeWait();if(t&&t.COMPLETED){}else{alert(t.ERROR)}BX.Sale.VkAdmin.exportProcessEpilog()},onfailure:function(){BX.debug("Feed SALE_VK_SETTINGS_RESET_ERROR")}})},clearErrorLog:function(t){BX.showWait();var e={action:"clearErrorLog",exportId:t,sessid:BX.bitrix_sessid()};BX.ajax({timeout:120,method:"POST",dataType:"json",url:BX.Sale.VkAdmin.ajaxUrl,data:e,onsuccess:function(t){BX.closeWait();if(t&&t.COMPLETED){BX.adjust(BX("vk_export_notify__error_normal"),{style:{display:"none"}});BX.adjust(BX("vk_export_notify__error_critical"),{style:{display:"none"}})}else{alert(t.MESSAGE)}},onfailure:function(){BX.debug("Feed SALE_VK_SETTINGS_RESET_ERROR")}})}}})(window);
//# sourceMappingURL=vk_admin.map.js